import{S as d,U as l}from"./index-aae2f258.js";import{u as n}from"./dropdown-689d2ad1.js";import{S as r}from"./sweetalert2.all-58477e35.js";const h=n();d();const c=l("module",{state:()=>({loading:!1,module:"",id:"",data:[],required_field:{},form:{}}),actions:{clear(){this.form={},this.data=[],this.required_field={}},async generate(s){try{this.loading=!0;const t=await this.axios.get("module/generate/"+this.module);this.form[s]=t.data,this.loading=!1}catch{}},set_form(s){this.required_field=[],this.form=Object.assign(this.form,{module:this.module,id:"",created_at:"",updated_at:"",created_by:"",updated_by:""}),s.map(t=>{t.fields.map(e=>{const o={};if(o[e.name]=e.default_value==null?"":e.default_value,this.form=Object.assign(this.form,o),e.type=="dropdown"?h.get_dropdown(e.name):e.type=="generate"&&(this.id==""||this.id===void 0)&&this.generate(e.name),e.required==1){const a={};a[e.name]=e.label,this.get_required_field(a)}})})},get_required_field(s){this.required_field=Object.assign(this.required_field,s)},async get_edit_form(){try{this.clear(),this.loading=!0;const s=await this.axios.get("module/edit/form/"+this.module),t=s.data.data;this.set_form(t.blocks),this.data=s.data.data,this.loading=!1}catch{}},async get(s){try{this.loading=!0;let t;t=await this.axios.get("module/"+s,{params:{module:this.module}});const e=t.data.data;Object.keys(this.form).map(a=>{a!="module"&&a!="related_module"&&(this.form[a]=e[a])}),this.loading=!1}catch{}},async save(){try{if(this.loading=!0,this.form.id==""){const t=await this.axios.post("module",this.form);this.form.id=t.data.data}else{const t=await this.axios.put("module/"+this.form.id,this.form)}this.router.push({name:"view",params:{id:this.form.id,module:this.form.module,action:"detail"}}),this.loading=!1}catch(t){const e=t.response;if(e.status==422){const o=Object.values(e.data.errors);var s="";o.map((a,i)=>{s=`<p class="text-red-500">${a[i]}</p>`}),r.fire({icon:"error",title:"Something wrong",html:s})}else e.status==500&&r.fire({icon:"error",title:"Something wrong",html:e.data.message});console.log(e),this.loading=!1}},async save_profile(){try{if(this.loading=!0,this.id==""){const t=await this.axios.post("module",this.form)}else await this.axios.put("module/"+this.form.id,this.form);this.router.push({name:"profile"}),this.loading=!1}catch(t){const e=t.response;if(e.status==422){const o=Object.values(e.data.errors);var s="";o.map((a,i)=>{s=`<p class="text-red-500">${a[i]}</p>`}),r.fire({icon:"error",title:"Something wrong",html:s})}else e.status==500&&r.fire({icon:"error",title:"Something wrong",html:e.data.message});console.log(e),this.loading=!1}}},persist:!0});export{c as u};
