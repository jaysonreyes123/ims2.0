import{C as B}from"./index-2412a5d3.js";import{B as F}from"./index-d37bd73e.js";import{d as U,M as H}from"./menu-767bf396.js";import{S as I,U as R,_ as G,a as u,b as s,c as r,d as m,w as S,f as e,F as v,D as y,t as a,h as b,g as h,r as L,n as j,C,R as z}from"./index-d9888335.js";import{B as A}from"./index-a7fa4ad6.js";import{u as T}from"./module-3c9806cd.js";import{M as E}from"./edit_map-1ba6d2c2.js";import{B as Y}from"./Breadcrum-b7890c5f.js";import{u as q}from"./related-1bd9762f.js";import"./index-39bd4386.js";import"./dropdown-387ba376.js";import"./sweetalert2.all-cbba3559.js";import"./mapbox-gl-geocoder-ebca00b9.js";import"./index-eef0ab71.js";I();const J=R("system",{state:()=>({loading:!1,current_page:1,last_page:0,is_last_page:!1,logs:[]}),getters:{},actions:{async activity_logs(o,t){try{this.loading=!0;const i=await this.axios.get("activity_logs/"+o+"/"+t+"?page="+this.current_page);this.logs.push(...i.data.data),this.last_page=i.data.meta.last_page,this.current_page<this.last_page?this.is_last_page=!1:this.is_last_page=!0,this.loading=!1}catch{}}},persist:!0}),d=J(),K={components:{Card:B,Button:F},data(){return{modules:this.$route.params.module,module_id:this.$route.params.id,SystemStore:d}},created(){},mounted(){d.loading=!1,d.is_last_page=!1,d.current_page=1,d.logs=[],d.activity_logs(this.modules,this.module_id)},methods:{scroll_paginate(){const o=window.scrollY+document.body.clientHeight,t=document.body.scrollHeight;o==t&&d.current_page<d.last_page&&(d.current_page++,d.activity_logs(this.modules,this.module_id))},load_more(){d.current_page++,d.activity_logs(this.modules,this.module_id)}},computed:{fields_computed(){let o;switch(this.$route.params.module){case"incidents":o=incidents_field;break;case"resources":o=resources_field;break;case"contacts":o=contacts_field;break;case"agencies":o=agency_fields;break}return o},fields(){const o=[];return this.fields_computed.map(t=>{t.fields.map(i=>{o[i.name]=i.label})}),o}}},O={class:"relative ltr:pl-2 rtl:pr-2"},P={class:"w-[250px] text-xs"},Q={class:"text-sm font-medium dark:text-slate-400-900 mb-1 text-slate-600"},W={class:"font-bold text-sky-500"},X={key:0},Z={class:"text-xs text-slate-600"},ee={class:"text-xs text-slate-600"},te={class:"text-xs text-slate-600"},se={key:1},oe={class:"text-xs"},le={key:0,class:"w-full mt-4 flex justify-center"};function re(o,t,i,M,l,x){const f=u("Button"),_=u("Card");return s(),r("div",null,[m(_,{title:"Updates",class:"mt-4"},{default:S(()=>[e("ul",O,[(s(!0),r(v,null,y(l.SystemStore.logs,(n,c)=>(s(),r("li",{key:c,class:"mt-5 flex"},[e("div",P,a(n.created_at),1),t[5]||(t[5]=e("div",{class:"w-[100px] ltr:border-l-2 rtl:border-r-2 border-slate-100 dark:border-slate-700 pb-4 last:border-none ltr:pl-[22px] rtl:pr-[22px] relative before:absolute ltr:before:left-[-8px] rtl:before:-right-2 before:top-[0px] before:rounded-full before:w-4 before:h-4 before:bg-slate-900 dark:before:bg-slate-600 before:leading-[2px] before:content-[url('@/assets/images/all-img/ck.svg')]"},null,-1)),e("div",null,[e("h2",Q,[e("span",W,a(n.whodid),1),b(" - "+a(n.action),1)]),n.status==2?(s(),r("div",X,[t[3]||(t[3]=e("p",{class:"text-xs dark:text-slate-400"},null,-1)),(s(!0),r(v,null,y(n.fields,p=>(s(),r("div",{key:p.id,class:"mb-2"},[e("p",Z,[e("b",null,a(p.label),1),t[0]||(t[0]=b(" changed"))]),e("p",ee,[t[1]||(t[1]=e("b",null,"From",-1)),b(": "+a(p.oldvalue),1)]),e("p",te,[t[2]||(t[2]=e("b",null,"To",-1)),b(": "+a(p.newvalue),1)])]))),128))])):n.status==4||n.status==5?(s(),r("div",se,[t[4]||(t[4]=e("p",{class:"text-xs dark:text-slate-400"},null,-1)),e("div",null,[e("p",oe,[e("b",null,a(n.fields.module),1),b(" - "+a(n.fields.entityname),1)])])])):h("",!0)])]))),128))]),l.SystemStore.is_last_page?h("",!0):(s(),r("div",le,[m(f,{text:"load more",onClick:x.load_more,isLoading:l.SystemStore.loading,btnClass:"btn-sm btn-outline-white"},null,8,["onClick","isLoading"])]))]),_:1})])}const ae=G(K,[["render",re]]);const k=T(),V=L(""),D=L(""),ne={name:"Summary",props:{props_id:{type:String,default:""},props_module:{type:String,default:""}},components:{Card:B,Map:E,Badge:A},data(){return{module_store:k}},created(){V.value=this.props_module==""?this.$route.params.module:this.props_module,D.value=this.props_id==""?this.$route.params.id:this.props_id},mounted(){k.module=V.value,k.get_edit_form(D.value,"summary")}},de={key:0},ie={class:"lg:grid gap-x-12",style:{"grid-template-columns":"1fr 1fr"}},ue={key:0,class:"fromGroup relative"},me={key:1,class:"fromGroup relative"},_e={class:"lg:grid lg:grid-cols-2 gap-12 mt-4"},ce={class:"fromGroup relative"},pe={class:"fromGroup relative"},ge={class:"lg:grid lg:grid-cols-2 gap-12"},fe={class:"fromGroup relative"},be={class:"fromGroup relative"};function he(o,t,i,M,l,x){const f=u("Loading"),_=u("Badge"),n=u("Card");return s(),r("div",null,[m(f,{active:l.module_store.loading,"onUpdate:active":t[0]||(t[0]=c=>l.module_store.loading=c)},null,8,["active"]),l.module_store.loading?h("",!0):(s(),r("div",de,[(s(!0),r(v,null,y(l.module_store.blocks,(c,p)=>(s(),r("div",{key:p},[m(n,{title:c.block,class:"mt-4 shadow-sm"},{default:S(()=>[e("div",ie,[(s(!0),r(v,null,y(c.fields,(g,N)=>(s(),r("div",{key:N,class:j([`custom-grid-${N%2}`,"mt-4"])},[g.type=="checkbox"?(s(),r("div",ue,[e("label",null,a(g.label),1),l.module_store.form[g.name]?(s(),C(_,{key:0,label:"Active",badgeClass:"bg-success-500 text-white"})):h("",!0),l.module_store.form[g.name]?h("",!0):(s(),C(_,{key:1,label:"Inactive",badgeClass:"bg-danger-500 text-white"}))])):(s(),r("div",me,[e("label",null,a(g.label),1),e("span",null,a(l.module_store.form[g.name]),1)]))],2))),128))])]),_:2},1032,["title"])]))),128)),m(n,{title:"System Generated",class:"mt-4 shadow-sm"},{default:S(()=>[e("div",_e,[e("div",ce,[t[1]||(t[1]=e("label",{for:""},"Created time",-1)),e("span",null,a(l.module_store.form.created_at),1)]),e("div",pe,[t[2]||(t[2]=e("label",{for:""},"Created By",-1)),e("span",null,a(l.module_store.form.created_by),1)])]),e("div",ge,[e("div",fe,[t[3]||(t[3]=e("label",{for:""},"Last updated",-1)),e("span",null,a(l.module_store.form.updated_at),1)]),e("div",be,[t[4]||(t[4]=e("label",{for:""},"Last updated by",-1)),e("span",null,a(l.module_store.form.updated_by),1)])])]),_:1})]))])}const ve=G(ne,[["render",he],["__scopeId","data-v-061d0183"]]),ye=T(),$=q(),w=L(""),xe={components:{Card:B,Button:F,Summary:ve,detail:U,update:ae,Breadcrum:Y,Menu:H},created(){$.related_menu=[],ye.entityname="",this.$watch(()=>this.$route.params.action,o=>{w.value=o})},mounted(){w.value=this.$route.params.action,$.get_related_menu(this.$route.params.module)},data(){return{action_module:w,related_store:$}},methods:{}};function ke(o,t,i,M,l,x){const f=u("Breadcrum"),_=u("Menu");return s(),r("div",null,[m(f,{mode:"view"}),m(_),(s(),C(z(l.action_module)))])}const He=G(xe,[["render",ke]]);export{He as default};
