import{L as z}from"./save-be43adda.js";import{B as G}from"./index-1bfbf0d9.js";import{I as M}from"./index-3e12b49d.js";import{I as j}from"./index-2129bf1d.js";import{T as q,C as D}from"./vue-select.es-87cb21a9.js";import{T as E}from"./index-8c299b0d.js";import{C as O}from"./index-31d27bbd.js";import{u as A}from"./dropdown-c096971e.js";import{u as H}from"./report-b92a7d65.js";import{r as S,_ as F,a as u,b as n,C as m,w,d,f as o,c as p,D as N,n as g,t as B,F as T,h as _,g as v,i as P}from"./index-919f49e3.js";import{S as Y}from"./sweetalert2.all-f63bff7b.js";const x=A(),r=H();S("");S([]);const J=[{label:"Equal",value:"="},{label:"Not Equal",value:"<>"}];let b=S(0),K=[{id:1,title:"Report Details"},{id:2,title:"Filters"},{id:3,title:"Select Chart"}];const Q=[{value:"pie",label:"Pie Chart"},{value:"vertical",label:"Vertical Bar Chart"},{value:"horizontal",label:"Horizontal Bar Chart"},{value:"line",label:"Line Chart"}],W=[{value:"count",label:"Record Count"}],X={components:{Button:G,Icon:M,Textinput:E,InputGroup:j,Textarea:q,Card:O,Select:D},mounted(){this.clear2(),b.value=0,r.id=this.$route.params.id,r.form.type="chart",x.get_dropdown("modules"),r.module_list=x.dropdownlist.modules,r.id!=""&&r.id!==void 0&&r.get()},data(){return{steps:K,stepNumber:b,dropdown_store:x,report:r,operator:J,chart_type:Q,data_fields:W}},methods:{clear2(){r.loading=!1,r.form.report_name="",r.form.modules="",r.form.selected_column=[],r.relation_module=[],r.form.related_module=[],r.form.chart.type="",r.form.chart.dataset=[],r.form.chart.group_by="",r.form.filter=[{field:"",operator:"",type:"text",value:""}]},clear(){r.form.selected_column=[],r.form.related_module=[],r.form.filter=[{field:"",operator:"",type:"text",value:""}]},andRemoveCondition(a){r.form.filter.splice(a,1)},andCondition(){r.form.filter.push({field:"",operator:"",type:"text",value:""})},filter_and_select_option(a,t){r.form.filter[t].type=a.type,r.form.filter[t].operator="=",a.type=="dropdown"&&(x.dropdownlist_data=[],x.get_dropdown_list(a.value))},SelectModule(a){this.clear(),r.module=a.name,r.get_relation_module()},prev(){b.value--},submit(){let a="";const t=this.$route.params.type;if(b.value==0)r.form.report_name==""&&(a+="<p class='text-red-500'>Report name is required</p>"),r.form.modules==""&&(a+="<p class='text-red-500'>Module is required</p>"),a==""&&r.get_fields();else if(b.value==1)r.form.selected_column.length==0&&t=="list"&&(a="<p class='text-red-500'>Column is required</p>");else if(b.value===2)return r.save(),!1;if(a!="")return Y.fire({icon:"error",title:"Something wrong",html:a}),!1;b.value++}}},Z={class:"flex z-[5] items-center relative justify-center md:mx-8"},$={key:0},ee={key:1,class:"text-3xl"},te={class:"w-max"},oe={class:"conten-box mt-14 border-t border-slate-100 dark:border-slate-700 -mx-6 px-6 pt-6"},le={key:0,class:"px-5"},re={class:"grid lg:grid-cols-4 grid-cols-2"},se={class:"grid lg:grid-cols-4 grid-cols-2"},ne={class:"grid lg:grid-cols-4 grid-cols-2"},ie={key:1,class:"px-5"},ae={class:"col-start-1 col-span-3"},de={class:"col-start-4 col-span-2"},pe={class:"col-start-6 col-span-3"},ue={class:"flex justify-center"},me=["onClick"],ce={key:2,class:"px-5"},fe={class:"fromGroup relative mt-5"},_e={class:"fromGroup relative mt-5"},be={class:"fromGroup relative mt-5"};function ve(a,t,L,R,e,f){const h=u("Loading"),y=u("Icon"),k=u("Textinput"),c=u("Select"),I=u("Textarea"),U=u("flat-pickr"),V=u("Button"),C=u("Card");return n(),m(C,null,{default:w(()=>[d(h,{active:e.report.loading,"onUpdate:active":t[0]||(t[0]=s=>e.report.loading=s)},null,8,["active"]),o("div",Z,[(n(!0),p(T,null,N(e.steps,(s,l)=>(n(),p("div",{class:"relative z-[1] items-center item flex flex-start flex-1 last:flex-none group",key:l},[o("div",{class:g([`   ${e.stepNumber>=l?"bg-slate-900 text-white ring-slate-900 ring-offset-2 dark:ring-offset-slate-500 dark:bg-slate-900 dark:ring-slate-900":"bg-white ring-slate-900 ring-opacity-70  text-slate-900 dark:text-slate-300 dark:bg-slate-600 dark:ring-slate-600 text-opacity-70"}`,"transition duration-150 icon-box md:h-12 md:w-12 h-7 w-7 rounded-full flex flex-col items-center justify-center relative z-[66] ring-1 md:text-lg text-base font-medium"])},[e.stepNumber<=l?(n(),p("span",$,B(l+1),1)):(n(),p("span",ee,[d(y,{icon:"bx:check-double"})]))],2),o("div",{class:g(["absolute top-1/2 h-[2px] w-full",e.stepNumber>=l?"bg-slate-900 dark:bg-slate-900":"bg-[#E0EAFF] dark:bg-slate-700"])},null,2),o("div",{class:g(["absolute top-full text-base md:leading-6 mt-3 transition duration-150 md:opacity-100 opacity-0 group-hover:opacity-100",e.stepNumber>=l?" text-slate-900 dark:text-slate-300":"text-slate-500 dark:text-slate-300 dark:text-opacity-40"])},[o("span",te,B(s.title),1)],2)]))),128))]),o("div",oe,[e.stepNumber===0?(n(),p("div",le,[t[11]||(t[11]=o("br",null,null,-1)),o("div",re,[t[8]||(t[8]=o("span",null,[_("Report Name"),o("span",{class:"text-red-500"},"*")],-1)),o("div",null,[d(k,{placeholder:"Report Name",modelValue:e.report.form.report_name,"onUpdate:modelValue":t[1]||(t[1]=s=>e.report.form.report_name=s)},null,8,["modelValue"])])]),t[12]||(t[12]=o("br",null,null,-1)),o("div",se,[t[9]||(t[9]=o("span",null,[_("Module"),o("span",{class:"text-red-500"},"*")],-1)),o("div",null,[d(c,{placeholder:"Select an option",options:e.dropdown_store.dropdownlist.modules,modelValue:e.report.form.modules,"onUpdate:modelValue":t[2]||(t[2]=s=>e.report.form.modules=s),"onOption:selected":f.SelectModule,reduce:s=>s.name},null,8,["options","modelValue","onOption:selected","reduce"])])]),t[13]||(t[13]=o("br",null,null,-1)),o("div",ne,[t[10]||(t[10]=o("span",null,[_("Relation Module ("),o("i",null,"Optional"),_(" )")],-1)),o("div",null,[d(c,{placeholder:"Select an option",options:e.report.relation_module,modelValue:e.report.form.related_module,"onUpdate:modelValue":t[3]||(t[3]=s=>e.report.form.related_module=s),reduce:s=>s.value,selectable:s=>e.report.form.related_module.length<2,multiple:""},null,8,["options","modelValue","reduce","selectable"])])])])):v("",!0),e.stepNumber===1?(n(),p("div",ie,[d(C,{title:"Choose List conditions"},{default:w(()=>[t[14]||(t[14]=o("br",null,null,-1)),t[15]||(t[15]=o("label",null,"All Conditions (All conditions must be met)",-1)),(n(!0),p(T,null,N(e.report.form.filter,(s,l)=>(n(),p("div",{class:"grid grid-cols-9 gap-8 mt-4",key:l},[o("div",ae,[d(c,{"onOption:selected":i=>f.filter_and_select_option(i,l),placeholder:"Select an option",options:e.report.fields_list,modelValue:e.report.form.filter[l].field,"onUpdate:modelValue":i=>e.report.form.filter[l].field=i,reduce:i=>i.value},null,8,["onOption:selected","options","modelValue","onUpdate:modelValue","reduce"])]),o("div",de,[d(c,{placeholder:"Select an option",options:e.operator,modelValue:e.report.form.filter[l].operator,"onUpdate:modelValue":i=>e.report.form.filter[l].operator=i,reduce:i=>i.value},null,8,["options","modelValue","onUpdate:modelValue","reduce"])]),o("div",pe,[e.report.form.filter[l].type=="text"?(n(),m(k,{key:0,placeholder:"",modelValue:e.report.form.filter[l].value,"onUpdate:modelValue":i=>e.report.form.filter[l].value=i},null,8,["modelValue","onUpdate:modelValue"])):e.report.form.filter[l].type=="textarea"?(n(),m(I,{key:1,modelValue:e.report.form.filter[l].value,"onUpdate:modelValue":i=>e.report.form.filter[l].value=i},null,8,["modelValue","onUpdate:modelValue"])):e.report.form.filter[l].type=="date"?(n(),m(U,{key:2,class:"form-control",placeholder:"yyyy-mm-dd",config:{dateFormat:"Y-m-d"},modelValue:e.report.form.filter[l].value,"onUpdate:modelValue":i=>e.report.form.filter[l].value=i},null,8,["modelValue","onUpdate:modelValue"])):e.report.form.filter[l].type=="time"?(n(),m(U,{key:3,class:"form-control",placeholder:"HH:mm:00",config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i:00",time_24hr:!0,minuteIncrement:1},modelValue:e.report.form.filter[l].value,"onUpdate:modelValue":i=>e.report.form.filter[l].value=i},null,8,["modelValue","onUpdate:modelValue"])):e.report.form.filter[l].type=="dropdown"?(n(),m(c,{key:4,placeholder:"Select an option",options:e.dropdown_store.dropdownlist_data},null,8,["options"])):(n(),m(k,{key:5,type:e.report.form.filter[l].type,placeholder:"",modelValue:e.report.form.filter[l].value,"onUpdate:modelValue":i=>e.report.form.filter[l].value=i},null,8,["type","modelValue","onUpdate:modelValue"]))]),o("div",ue,[l!==0?(n(),p("button",{key:0,type:"button",class:"inline-flex items-center justify-center h-10 w-10 bg-danger-500 text-lg border rounded border-danger-500 text-white",onClick:i=>f.andRemoveCondition(l)},[d(y,{icon:"heroicons-outline:trash"})],8,me)):v("",!0)])]))),128)),d(V,{icon:"heroicons-outline:plus",text:"Add Condition",btnClass:"btn-success mr-2 py-2 mt-3",onClick:f.andCondition},null,8,["onClick"])]),_:1})])):v("",!0),e.stepNumber===2?(n(),p("div",ce,[d(C,{title:"Select chart type"},{default:w(()=>[o("div",fe,[t[16]||(t[16]=o("label",{class:"flex-0 mr-6 break-words ltr:inline-block rtl:block input-label"},[_("Chart type"),o("span",{class:"text-red-500"},"*")],-1)),d(c,{placeholder:"Select an option",options:e.chart_type,modelValue:e.report.form.chart.type,"onUpdate:modelValue":t[4]||(t[4]=s=>e.report.form.chart.type=s),reduce:s=>s.value},null,8,["options","modelValue","reduce"])]),o("div",_e,[t[17]||(t[17]=o("label",{class:"flex-0 mr-6 break-words ltr:inline-block rtl:block input-label"},[_(" Select Data Fields "),o("span",{class:"text-red-500"},"*")],-1)),d(c,{placeholder:"Select an option",options:e.data_fields,multiple:"",modelValue:e.report.form.chart.dataset,"onUpdate:modelValue":t[5]||(t[5]=s=>e.report.form.chart.dataset=s),reduce:s=>s.value},null,8,["options","modelValue","reduce"])]),o("div",be,[t[18]||(t[18]=o("label",{class:"flex-0 mr-6 break-words ltr:inline-block rtl:block input-label"},[_(" Select Groupby Field "),o("span",{class:"text-red-500"},"*")],-1)),d(c,{placeholder:"Select an option",options:e.report.fields_list,modelValue:e.report.form.chart.group_by,"onUpdate:modelValue":t[6]||(t[6]=s=>e.report.form.chart.group_by=s),reduce:s=>s.value},null,8,["options","modelValue","reduce"])])]),_:1})])):v("",!0),o("div",{class:g(["mt-10",e.stepNumber>0?"flex justify-between":" text-right"])},[this.stepNumber!==0?(n(),m(V,{key:0,onClick:t[7]||(t[7]=P(s=>f.prev(),["prevent"])),text:"prev",btnClass:"btn-dark"})):v("",!0),d(V,{onClick:f.submit,text:e.stepNumber!==this.steps.length-1?"next":"Save and Generate",btnClass:"btn-dark"},null,8,["onClick","text"])],2)])]),_:1})}const xe=F(X,[["render",ve]]),ye={components:{List:z,Chart:xe}};function ge(a,t,L,R,e,f){const h=u("List"),y=u("Chart");return n(),p("div",null,[this.$route.params.type=="list"?(n(),m(h,{key:0})):this.$route.params.type=="chart"?(n(),m(y,{key:1})):v("",!0)])}const Le=F(ye,[["render",ge]]);export{Le as default};
